% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{estimate_ML}
\alias{estimate_ML}
\title{Estimate parameters via maximum likelihood}
\usage{
estimate_ML(
  df_data,
  s_range = c(-1, 1),
  s_intervals = 101,
  p_range = c(0, 1),
  p_intervals = 101
)
}
\arguments{
\item{df_data}{A data frame with observed prevalence data. Must include columns:
\code{pop} (population ID), \code{t} (time as a Date), \code{n_samp} (sample size), and
\code{n_pos} (number of individuals carrying the allele).}

\item{s_range}{A numeric vector of length 2 specifying the range of selection coefficients
to explore (default is \code{c(-1, 1)}).}

\item{s_intervals}{The number of values of \code{s} to explore between the
limits of \code{s_range} (default is 101).}

\item{p_range}{A numeric vector of length 2 specifying the range of initial
allele frequencies to explore (default is \code{c(0, 1)}).}

\item{p_intervals}{The number of values of \code{p} to explore between the
limits of \code{p_range} (default is 101).}
}
\value{
A data frame with one row per population, containing:
\describe{
  \item{pop}{Population ID.}
  \item{p0}{Maximum likelihood estimate of initial allele frequency.}
  \item{s}{Maximum likelihood estimate of selection coefficient.}
  \item{s_lower}{Lower bound of 95\% confidence interval for \code{s}.}
  \item{s_upper}{Upper bound of 95\% confidence interval for \code{s}.}
}
}
\description{
Estimates the selection coefficient (\code{s}) and initial allele frequency (\code{p0})
using maximum likelihood. A grid search is performed over a parameter space, and the
log-likelihood is computed based on a deterministic logistic model. Confidence intervals
for \code{s} are calculated using a profile likelihood approach. If multiple populations
are provided, estimates are computed independently for each one.
}
