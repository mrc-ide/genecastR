% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{run_mcmc}
\alias{run_mcmc}
\title{Estimate parameters via Bayesian MCMC}
\usage{
run_mcmc(
  df_data,
  dx = 0.01,
  t_min = 1,
  burnin = 100,
  samples = 1000,
  chains = 1,
  prior_s = function(s) dlnorm_reparam(s, mean = 0.01, sd = 0.01, return_log = TRUE),
  prior_sigma = function(sigma) dlnorm_reparam(sigma, mean = 0.01, sd = 0.01, return_log
    = TRUE),
  s_init = 0.01,
  sigma_init = 0.01,
  x_init = seq(0, 1, dx),
  pb_markdown = FALSE,
  silent = FALSE
)
}
\arguments{
\item{df_data}{A data frame of observed prevalence data, with columns:
\code{pop} (population ID), \code{t} (generation), \code{n_samp} (sample size), and \code{n_pos} (number of positive observations).}

\item{dx}{Step size for discretizing allele frequencies (default is \code{0.01}).}

\item{t_min}{The starting generation for likelihood calculation (default is \code{1}).}

\item{burnin}{Number of burn-in iterations per chain (default is \code{1e2}).}

\item{samples}{Number of post-burn-in MCMC samples per chain (default is \code{1e3}).}

\item{chains}{Number of independent MCMC chains to run (default is \code{1}).}

\item{prior_s}{A function specifying the log-prior for the selection coefficient \code{s}.}

\item{prior_sigma}{A function specifying the log-prior for the diffusion parameter \code{sigma}.}

\item{s_init}{Initial value for \code{s} in the MCMC (default is \code{0.01}).}

\item{sigma_init}{Initial value for \code{sigma} in the MCMC (default is \code{0.01}).}

\item{x_init}{Initial allele frequency distribution vector (default is \code{seq(0, 1, dx)}).}

\item{pb_markdown}{Logical; whether to show progress bars suitable for markdown output (default is \code{FALSE}).}

\item{silent}{Logical; whether to suppress console output during MCMC (default is \code{FALSE}).}
}
\value{
A list containing MCMC results as returned by \code{drjacoby::run_mcmc()}, including posterior samples for all parameters.
}
\description{
Runs MCMC using the \code{drjacoby} package to estimate the selection coefficient (\code{s}) and diffusion parameter (\code{sigma})
under a diffusion approximation to the Wright-Fisher model. Allows for multiple populations (each assumed to follow independent trajectories)
and returns full posterior samples.
}
